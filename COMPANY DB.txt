CREATE TABLE EMPLOYEEb(
EID INT PRIMARY KEY,
NAME VARCHAR2(20),
ADDRESS VARCHAR2(20),
GENDER CHAR(1) ,
SALARY NUMBER(6),
SUPEREID REFERENCES EMPLOYEEb(EID),
DNO NUMBER);
INSERT INTO EMPLOYEEb VALUES(1,'RAHUL','MANGALURU','M',45000,1,NULL);
INSERT INTO EMPLOYEEb VALUES(2,'SANJANA','MANGALURU','F',55000,1,NULL);
INSERT INTO EMPLOYEEb VALUES(3,'VIKAS','BENGALURU','M',65000,1,NULL);
INSERT INTO EMPLOYEEb VALUES(4,'VAISHAK','MANGALURU','M',75000,1,NULL);
INSERT INTO EMPLOYEEb VALUES(5,'PARTH','DELHI','M',600000,1,NULL);
SET PAGESIZE 200 LINESIZE 3000;
SELECT * FROM EMPLOYEEb;

ALTER TABLE EMPLOYEEb 
ADD CONSTRAINT FKb FOREIGN KEY(DNO) REFERENCES DEPARTMENTa(DNUM);
UPDATE EMPLOYEEb SET DNO=4 WHERE EID=1;
UPDATE EMPLOYEEb SET DNO=1 WHERE EID=2;
UPDATE EMPLOYEEb SET DNO=3 WHERE EID=3;
UPDATE EMPLOYEEb SET DNO=3 WHERE EID=4;
UPDATE EMPLOYEEb SET DNO=3 WHERE EID=5;
SELECT * FROM EMPLOYEEb;


CREATE TABLE DEPARTMENTb(
DNUM NUMBER(5) PRIMARY KEY,
DNAME VARCHAR2(10),
DMGR_ID REFERENCES EMPLOYEEb(EID),
MGR_START_DATE DATE);
INSERT INTO DEPARTMENTb VALUES(1,'CSE',1,'1-NOV-2007');
INSERT INTO DEPARTMENTb VALUES(2,'IOT',2,'2-NOV-2007');
INSERT INTO DEPARTMENTb VALUES(3,'ACCOUNT',2,'2-NOV-2017');
INSERT INTO DEPARTMENTb VALUES(4,'ISE',1,'2-NOV-2000');
INSERT INTO DEPARTMENTb VALUES(5,'AIML',1,'3-NOV-2001');
SELECT * FROM DEPARTMENTb;


CREATE TABLE DLOCATIONb(
DNO REFERENCES DEPARTMENTb(DNUM),
LOCATION VARCHAR2(10),
PRIMARY KEY(DNO,LOCATION));
INSERT INTO DLOCATIONb VALUES(1,'MANGALURU');
INSERT INTO DLOCATIONb VALUES(1,'DELHI');
INSERT INTO DLOCATIONb VALUES(2,'MANGALURU');
INSERT INTO DLOCATIONb VALUES(3,'BENGALURU');
INSERT INTO DLOCATIONb VALUES(4,'MANGALURU');
INSERT INTO DLOCATIONb VALUES(5,'MANGALURU');
CREATE TABLE PROJECTb(
PNUM NUMBER(2) PRIMARY KEY,
PNAME VARCHAR2(20),
PLOCATION VARCHAR2(20),
DNO NUMBER REFERENCES DEPARTMENTb(DNUM));
INSERT INTO PROJECTb VALUES(1,'IOT','MANGALURU',1);
INSERT INTO PROJECTb VALUES(2,'DATA MINING','MANGALURU',1);
INSERT INTO PROJECTb VALUES(3,'CC','HUBLI',3);
INSERT INTO PROJECTb VALUES(4,'IMAGE PROCESSING','MANGALURU',4);
INSERT INTO PROJECTb VALUES(5,'RESEARCH','MANGALURU',5);
SELECT * FROM PROJECTb;

CREATE TABLE WORKSONb(
EID NUMBER(5) REFERENCES EMPLOYEEb(EID),
PNO NUMBER(2)REFERENCES PROJECTb(PNUM),
HOURS NUMBER(5,2),
PRIMARY KEY(EID,PNO));
INSERT INTO WORKSONb VALUES(1,1,4);
INSERT INTO WORKSONb VALUES(2,1,5);
INSERT INTO WORKSONb VALUES(3,2,4);
INSERT INTO WORKSONb VALUES(4,3,4);
INSERT INTO WORKSONb VALUES(5,5,4);
SELECT * FROM WORKSONb;

CREATE TABLE DEPENDENTb(
EMPID INT CONSTRAINT DEP_EMPID_PKb PRIMARY KEY,
DEP_NAME VARCHAR2(12),
GENDER VARCHAR2(5),
BDATE DATE,
RELATIONSHIP VARCHAR2(12), 
FOREIGN KEY(EMPID)REFERENCES EMPLOYEEb(EID) ON DELETE CASCADE);
INSERT INTO DEPENDENTb VALUES(1,'SHREYA','F','22-JAN-75','WIFE');
INSERT INTO DEPENDENTb VALUES(2,'AKASH','M','15-JUN-77','BROTHER');
INSERT INTO DEPENDENTb VALUES(3,'PRIYA','F','10-SEP-80','SISTER');
INSERT INTO DEPENDENTb VALUES(4,'NIKHIL','M','02-FEB-79','FATHER');
INSERT INTO DEPENDENTb VALUES(5,'AKSHA','F','30-OCT-75','MOTHER');
SELECT * FROM DEPENDENTb;

Q1
SELECT PNO 
FROM WORKSONb 
WHERE EID IN(SELECT EID FROM EMPLOYEEb WHERE NAME='RAHUL')
UNION 
SELECT PNUM 
FROM PROJECTa 
WHERE DNO IN(SELECT DNUM FROM DEPARTMENTb WHERE DMGR_ID IN
(SELECT EID FROM EMPLOYEEb WHERE NAME ='RAHUL'));

Q2
SELECT EID,NAME,SALARY,SALARY+0.1*SALARY AS UPDATED_SALARY
FROM EMPLOYEEb
WHERE EID IN 
(SELECT EID FROM WORKSONb WHERE PNO IN(
SELECT PNUM FROM PROJECTb WHERE PNAME='IOT'));

Q3
SELECT SUM(SALARY),AVG(SALARY),MAX(SALARY),MIN(SALARY)
FROM EMPLOYEEb E, DEPARTMENTb D
WHERE D.Dnum=E.Dno AND Dname='ACCOUNT';

Q4
SELECT Eid ,NAME 
FROM EMPLOYEEb E 
WHERE NOT EXISTS((SELECT PNUM FROM PROJECTb WHERE Dno=5) MINUS
(SELECT Pno FROM WORKSONb W WHERE W.Eid=E.Eid));

Q5
CREATE VIEW DEPTINFOb (NAME,COUNT_EMP,SUM_SAL)AS
SELECT D.DNAME, COUNT(*),SUM(SALARY)
FROM DEPARTMENTb D INNER JOIN EMPLOYEEb E
ON E.DNO=D.DNUM
GROUP BY D.DNAME;

SELECT * FROM DEPTINFOb;