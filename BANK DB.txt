CREATE TABLE BRANCHa(
BRANCH_ID VARCHAR(10),
BANK_NAME VARCHAR(15),
BRANCH_NAME VARCHAR(20),
ASSETS INT NOT NULL,
PRIMARY KEY(BRANCH_ID));
INSERT INTO BRANCHa VALUES('B1',' CANARA','MANGALURU',60000000);
INSERT INTO BRANCHa VALUES('B2','BANK OF BARODA','MANGALURU',70000000);
INSERT INTO BRANCHa VALUES('B3','ICIC','KASAROGOD',50000000);
SELECT * FROM BRANCHa;

CREATE TABLE CUSTOMERa(
CUSTOMER_ID VARCHAR(10),
CUSTOMER_NAME VARCHAR(20),
CUSTOMER_AGE INT,
CUSTOMER_ADDRESS VARCHAR(20),
CUSTOMER_PHONE INT,
PRIMARY KEY(CUSTOMER_ID));
INSERT INTO CUSTOMERa VALUES('C1','OM',22,'MANGALURU',12346);
INSERT INTO CUSTOMERa VALUES('C2','RAHUL',26,'DELHI',23473);
INSERT INTO CUSTOMERa VALUES('C3','VAISHAK',23,'KASARGOD',64778);
SELECT * FROM CUSTOMERa;

CREATE TABLE ACCOUNTa(
ACC_NO INT,
BRANCH_ID VARCHAR(10),
ACCOUNT_TYPE VARCHAR(10),
ACCOUNT_BALANCE INT,
CUSTOMER_ID VARCHAR(10),
PRIMARY KEY(ACC_NO),
FOREIGN KEY (BRANCH_ID) REFERENCES BRANCHa(BRANCH_ID) ON DELETE CASCADE,
FOREIGN KEY(CUSTOMER_ID) REFERENCES CUSTOMERa(CUSTOMER_ID) ON DELETE CASCADE );
INSERT INTO ACCOUNTa VALUES(1,'B1','SAVINGS',30000,'C1');
INSERT INTO ACCOUNTa VALUES(2,'B2','FD',5000,'C3');
INSERT INTO ACCOUNTa VALUES(3,'B3','CURRENT',90000,'C2');
SELECT * FROM ACCOUNTa;


CREATE TABLE LOANa(
LOAN_NUMBER VARCHAR2(5),
BRANCH_ID VARCHAR(10),
AMOUNT INT,
CUSTOMER_ID VARCHAR(10), 
PRIMARY KEY(LOAN_NUMBER),
FOREIGN KEY (BRANCH_ID) REFERENCES BRANCHa(BRANCH_ID) ON DELETE CASCADE,
FOREIGN KEY(CUSTOMER_ID) REFERENCES CUSTOMERa(CUSTOMER_ID) ON DELETE CASCADE);
INSERT INTO LOANa VALUES('L2','B2',10000,'C2');
INSERT INTO LOANa VALUES('L3','B3',20000,'C3');
INSERT INTO LOANa VALUES('L1','B2',565000,'C1');
SELECT * FROM LOANa;

Q1
SELECT C.CUSTOMER_ID,C.CUSTOMER_NAME 
FROM CUSTOMERa C,ACCOUNTa A,BRANCHa B
WHERE B.BRANCH_NAME='MANGALURU'AND B.BRANCH_ID=A.BRANCH_ID 
AND A.CUSTOMER_ID=C.CUSTOMER_ID;

Q2
SELECT C.CUSTOMER_ID,C.CUSTOMER_NAME,A.ACCOUNT_BALANCE 
FROM CUSTOMERa C,ACCOUNTa A
WHERE C.CUSTOMER_ID=A.CUSTOMER_ID AND 
ACCOUNT_BALANCE=(SELECT MAX(ACCOUNT_BALANCE)FROM ACCOUNTa);

Q3
SELECT C.CUSTOMER_NAME C,L.AMOUNT 
FROM CUSTOMERa C,LOANa L 
WHERE C.CUSTOMER_ID=L.CUSTOMER_ID AND AMOUNT>500000;

Q4
SELECT BANK_NAME,BRANCH_NAME,ASSETS 
FROM BRANCHa 
WHERE ASSETS=(SELECT MAX(ASSETS)FROM BRANCHa)
UNION 
SELECT BANK_NAME,BRANCH_NAME,ASSETS 
FROM BRANCHa 
WHERE ASSETS=(SELECT MIN(ASSETS)FROM BRANCHa);

Q5
DELETE FROM BRANCHa WHERE BRANCH_NAME='MANGALURU';
SELECT * FROM BRANCHa















